<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="FlowMo: Variance-Based Flow Guidance for Coherent Motion in Video Generation">
  <meta name="keywords" content="Video generation, Motion coherence, Diffusion models">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FlowMo: Variance-Based Flow Guidance for Coherent Motion in Video Generation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <style>
    .video-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .video-item-custom {
      text-align: center;
    }

    .video-item-custom video {
      width: 100%;
      height: auto;
      border-radius: 8px;
    }

    .video-caption {
      margin-top: 10px;
      font-size: 14px;
      color: #666;
    }

    .video-title {
      margin-bottom: 10px; /* Space between title and video */
      font-weight: bold;
      text-align: center;
    }

    .comparison-section {
      margin: 40px 0;
    }

    .motivation-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      max-width: 1000px;
      margin: 20px auto;
    }

    .motivation-grid video {
      width: 100%;
      height: auto;
      border-radius: 4px;
    }

    .center-video {
      max-width: 600px;
      margin: 20px auto;
      text-align: center;
    }

    .center-image {
      max-width: 500px;
      margin: 20px auto;
      text-align: center;
    }
  </style>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">FlowMo: Variance-Based Flow Guidance for Coherent Motion in Video Generation</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://scholar.google.com/citations?hl=en&user=A31XmP0AAAAJ">Ariel Shaulov*</a><sup></sup>,</span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=1ebLvzgAAAAJ&hl=en&oi=ao">Itay Hazan*</a><sup></sup>,</span>
            <span class="author-block">
              <a href="http://www.cs.tau.ac.il/~wolf/">Lior Wolf</a><sup></sup>,</span>
            <span class="author-block">
              <a href="https://hila-chefer.github.io/">Hila Chefer</a><sup></sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <p class="video-caption">Tel Aviv University, * Denotes equal contribution</p>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- arXiv Link. -->
              <span class="link-block">
                <a href="#"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="#"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Text-to-video diffusion models are notoriously limited in their ability to model temporal
            aspects such as motion, physics, and dynamic interactions. Existing approaches address this
            limitation by retraining the model or introducing external conditioning signals to enforce
            temporal consistency. In this work, we explore whether a meaningful temporal representation can
            be extracted directly from the predictions of a pre-trained model without any additional
            training or auxiliary inputs. We introduce <strong>FlowMo</strong>, a novel training-free
            guidance method that enhances motion coherence using only the model's own predictions in each
            diffusion step.
          </p>
          <p>
            FlowMo first derives an appearance-debiased temporal representation by measuring the distance
            between latents corresponding to consecutive frames. This highlights the implicit temporal
            structure predicted by the model.
            It then estimates motion coherence by measuring the patch-wise variance across the temporal
            dimension, and guides the model to reduce this variance dynamically during sampling. Extensive
            experiments across multiple text-to-video models demonstrate that FlowMo significantly improves
            motion coherence without sacrificing visual quality or prompt alignment, offering an effective
            plug-and-play solution for enhancing the temporal fidelity of pre-trained video diffusion
            models.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>

<!-- Qualitative Comparison Section -->
<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">Qualitative Comparison: FlowMo vs. Base Models</h2>
    
    <div class="content">
      <p class="has-text-centered">
        As mentioned in the paper, <strong>FlowMo is a novel training-free guidance method that enhances motion
        coherence</strong>. In this section, we provide an
        <strong>apples-to-apples</strong> qualitative comparison showing the impact of FlowMo on the base model
        (Wan2.1-1.3B, CogVideoX-5B). The comparisons are conducted with the same random seed on diverse prompts
        that capture a variety of motion types.
        <strong>Use the arrows to navigate through the results.</strong>
      </p>
    </div>

    <!-- Wan2.1-1.3B Results -->
    <h3 class="title is-4 has-text-centered comparison-section">Wan2.1-1.3B</h3>
    
    <div id="wan-carousel" class="carousel results-carousel">
      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_boy_with_glasses_flying_a_kite_in_a_grassy_field_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A boy with glasses flying a kite in a grassy field.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/gym_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A  woman performing a challenging exercise.</div>
        </div>
      </div>
      
      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_dolphin_jumping_out_of_ocean_waves_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A dolphin jumping out of ocean waves.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_ninja_flipping_through_a_bamboo_forest_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A ninja flipping through a bamboo fores.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_person_rowing_a_boat_across_a_misty_lake_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A person rowing a boat across a misty lake.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_roulette_wheel_in_a_dimly_lit_room_or_casino_flo_1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A roulette wheel in a dimly lit room or casino floor.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_senior_couple_dancing_at_sunset_on_a_pier_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A senior couple dancing at sunset on a pier.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_woman_in_a_flowing_dress_dancing_in_a_field_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A woman in a flowing dress dancing in a field.</div>
        </div>
      </div>


      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_child_jumping_on_a_trampoline_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A child jumping on a trampoline.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_helicopter_flying_over_a_forest._The_helicopter__1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A helicopter flying over a forest.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/Pikachu_roasting_marshmallows_with_Charmander_at_a_42_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">Pikachu with Charmander at a campfire.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_wan/A_painter_creating_a_landscape_on_canvas_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A painter creating a landscape on canvas.</div>
        </div>
      </div>


    </div>

    <!-- CogVideoX-5B Results -->
    <h3 class="title is-4 has-text-centered comparison-section">CogVideoX-5B</h3>
    
    <div id="cog-carousel" class="carousel results-carousel">

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_cog/violin_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A violinist performing a solo on stage.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_cog/A_pair_of_flamingos_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A pair of flamingos wading through shallow wate.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
          <div class="video-item video-item-new">
              <video loading="lazy" autoplay loop muted>
                  <source src="out_cog/A_ballerina_leaping_through_concat.mp4" type="video/mp4">
              </video>
              <div class="video-title">A ballerina leaping through the air.</div>
          </div>
          <div class="video-item video-item-new">
              <video loading="lazy" autoplay loop muted>
                  <source src="out_cog/A_deer_leaping_over_concat.mp4" type="video/mp4">
              </video>
              <div class="video-title">A deer leaping over a fallen log.</div>
          </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_cog/A_potter_shaping_clay_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A potter shaping clay on a spinning wheel.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_cog/A_skateboarder_performing_an_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A teenager skateboarding down a handrail.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_cog/A_falcon_swooping_down_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A falcon swooping down.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_cog/A_golfer_following_through_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A golfer following through on a perfect swing.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_cog/A_bee_collecting_pollen_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A bee collecting pollen from a vibrant flower.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_cog/A_chef_flipping_vegetables_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A chef flipping vegetables in a wok with dramatic flames.</div>
        </div>
      </div>


    </div>
  </div>
</section>

<!-- FlowMo vs FreeInit Comparison -->
<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">Qualitative Comparison: FlowMo vs. FreeInit</h2>
    
    <div class="content">
      <p class="has-text-centered">
        As mentioned in the paper, <strong>we compare FlowMo with FreeInit</strong>, a method originally
        designed for UNet-based DDPM/DDIM models that suffer from temporal artifacts due to signal-to-noise
        ratio (SNR) discrepancies between training and inference. These artifacts often result in
        inconsistencies across frames (e.g., identity or background shifts).
        In contrast, FlowMo operates on modern Transformer-based models trained with Flow Matching (FM), which
        offer greater temporal consistency due to stronger architectures and training on large-scale data. For a
        fair comparison, we adapted FreeInit to FM-based DiT models by applying its re-noising strategy to
        initialize low-frequency components.
        <strong>Use the arrows to navigate through the results.</strong>
      </p>
    </div>

    <div id="freeinit-carousel" class="carousel results-carousel">

      <div class="carousel-item carousel-item-new">
          <div class="video-item video-item-new">
              <video loading="lazy" autoplay loop muted>
                  <source src="out_freeinit/1_Athletic_man_doing_gymnastics_elements_on_horizont_1024_concat.mp4" type="video/mp4">
              </video>
              <div class="video-title">Athletic man doing gymnastics on a horizontal bar.</div>
          </div>
          <div class="video-item video-item-new">
              <video loading="lazy" autoplay loop muted>
                  <source src="out_freeinit/1_Young_Adult_Male_Doing_Handstand_on_the_beach._1024_concat.mp4" type="video/mp4">
              </video>
              <div class="video-title">Young adult male doing a handstand on the beach.</div>
          </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_freeinit/1_A_small_dog_playing_with_a_red_ball_on_a_hardwood__1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A small dog playing with a red ball on a hardwood floor.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_freeinit/1_A_man_jumping_rope_on_a_dark_stage._His_movements__1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A man jumping rope on a dark stage.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_freeinit/1_Arc_camera_shot._A_young_woman_doing_stretches_on__1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A young woman doing stretches on the beach.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_freeinit/1_A_close-up_of_a_person’s_feet_as_they_walk_through_1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A close-up of a person's feet as they walk through flowers.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_freeinit/1_A_person_lifts_one_knee_high_in_a_marching_motion,_1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A person lifts one knee high in a marching motion.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_freeinit/1_A_young_woman_practicing_boxing_in_a_gym._1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A young woman practicing boxing in a gym.</div>
        </div>
      </div>

      <div class="carousel-item carousel-item-new">
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_freeinit/A_female_kayaker_paddling_through_white_water_rapi_72_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">A female kayaker paddling through white water rapids.</div>
        </div>
        <div class="video-item video-item-new">
            <video loading="lazy" autoplay loop muted>
                <source src="out_freeinit/An_origami_bird_transforming_into_a_real_dove_and__1024_concat.mp4" type="video/mp4">
            </video>
            <div class="video-title">An origami bird transforming into a real dove and taking flight.</div>
        </div>
      </div>


    </div>
  </div>
</section>

<!-- Motivation for FlowMo Section -->
<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">Motivation for FlowMo</h2>
    
    <div class="content">
      <p>
        FlowMo arose from the observation that videos with coherent and incoherent motion exhibit separation in
        a measure we defined as <strong>Patch-Wise Variance</strong>. Given a tensor, we first compute the
        ℓ<sub>1</sub>-distance between consecutive latent frames to eliminate their common appearance
        information and get a debiased motion representation. We then compute patch-wise temporal variance, and
        finally take its mean value across channels.
      </p>

      <div class="center-video">
        <video autoplay loop muted playsinline>
          <source src="./method.mp4" type="video/mp4">
        </video>
        <p class="video-caption">Patch-Wise Variance of a Latent Video</p>
      </div>

      <p>
        After examining the patch-wise variance of the model's prediction when generating videos with coherent
        and incoherent motion, we found that the model's predictions for coherent motion consistently exhibited
        lower patch-wise variance compared to those for incoherent motion, as seen in the figure below.
        Intuitively, in videos with smooth and consistent motion, object trajectories evolve gradually,
        resulting in lower temporal variance. In contrast, incoherent motion introduces abrupt changes,
        manifesting as larger fluctuations and higher patch-wise variance in the latent predictions.
      </p>

      <div class="center-image">
        <img src="./separation_on_tagged_videos_model_output_mean.jpg" alt="Patch-wise variance">
        <p class="video-caption">Patch-Wise Variance of a Latent Video</p>
      </div>

      <p>
        We have therefore proposed to use this measure to guide the model to reduce the patch-wise variance
        during sampling, thus encouraging it to produce a prediction which is more likely to demonstrate
        coherent motion. After each timestep of the first 12 timesteps, <strong>FlowMo</strong> minimizes the 
        maximum patch-wise variance of the model's prediction, which results in an adjusted latent for the next
        timestep. We chose the first 12 timesteps because we found that coarse spatial information is determined 
        in the first steps (0-4) and motion is determined at around steps 5-8 (and refined later), as seen in 
        the figures below.
      </p>

      <div class="motivation-grid">
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=0_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=1_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=2_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=3_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=4_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=5_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=6_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=7_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=8_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=9_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=10_c=0.mp4" type="video/mp4">
          </video>
        </div>
        <div>
          <video autoplay loop muted playsinline>
            <source src="channels/athletic_t=11_c=0.mp4" type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <p>If you find this project useful for your research, please cite the following:
    </p>
    <pre><code>@article{flowmo2024,
  title={FlowMo: Variance-Based Flow Guidance for Coherent Motion in Video Generation},
  author={Shaulov, Ariel and Hazan, Itay and Wolf, Lior and Chefer, Hila},
  journal={arXiv preprint arXiv:XXXX.XXXXX},
  year={2024}
}</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="https://github.com/arielshaulov" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            Website source code based on the
            <a rel="Nerfies"
               href="https://nerfies.github.io/">Nerfies</a>
             project page. If you want to reuse their
             <a rel="source code"
               href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>, please credit them appropriately.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<script>
  // Initialize carousels
  document.addEventListener('DOMContentLoaded', function() {
    const carousels = bulmaCarousel.attach('.carousel', {
      slidesToScroll: 1,
      slidesToShow: 1,
      infinite: true,
      autoplay: false,
    });
  });
</script>

</body>
</html>
